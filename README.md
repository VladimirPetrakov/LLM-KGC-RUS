# Knowledge Graph Embeddings & Completion (Russian Language)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è, –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö, –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ–±—É—á–∞—é—â–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞, –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ TransE, –∞ —Ç–∞–∫–∂–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–∏–ø–ª–µ—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é LLM.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **build_russian_dataset.py**  
  –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç URI –≤ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ –º–µ—Ç–æ–∫.
- **generate_train_dataset.py**  
  –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—É—á–∞—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç —Å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏, –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.
- **embeddings.py**  
  –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å TransE, —Ä–µ–∞–ª–∏–∑—É–µ—Ç hard negative sampling, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ.
- **generate_llm_finetune_dataset.py**  
  –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
- **train_llm.py**  
  –î–æ—É–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- **main.py**  
  –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è tail, —Å—Ç—Ä–æ–∏—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM, –ø–∞—Ä—Å–∏—Ç –æ—Ç–≤–µ—Ç, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏.
- **dataset/**  
  –ö–∞—Ç–∞–ª–æ–≥ —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
- **embeddings/**  
  –ö–∞—Ç–∞–ª–æ–≥ —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.
- **finetuned_model/**  
  –ö–∞—Ç–∞–ª–æ–≥ —Å –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø–æ —à–∞–≥–∞–º

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã `labels_ru.txt` (–º–µ—Ç–∫–∏) –∏ `relations_en.txt` (—Ç—Ä–∏–ø–ª–µ—Ç—ã –≤ URI) –≤ –ø–∞–ø–∫—É `dataset/`.

2. –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ URI –≤ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –º–µ—Ç–∫–∏:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
     ```
     python build_russian_dataset.py
     ```
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ñ–∞–π–ª `dataset/relations_ru.txt` —Å —Ç—Ä–∏–ø–ª–µ—Ç–∞–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—É—á–∞—é—â–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –æ–±—É—á–∞—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç —Å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
     ```
     python generate_train_dataset.py
     ```
   - –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `dataset/relations_ru_train.tsv`.

2. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–∏–ø–ª–µ—Ç–æ–≤:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `analyze_dataset` –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–∏–ø—Ç–∞ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞.

### 3. –û–±—É—á–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

1. –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å TransE –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
     ```
     python embeddings.py
     ```
   - –°–∫—Ä–∏–ø—Ç –æ–±—É—á–∏—Ç –º–æ–¥–µ–ª—å, —Å–æ—Ö—Ä–∞–Ω–∏—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –≤ –ø–∞–ø–∫—É `embeddings/`, –∞ —Ç–∞–∫–∂–µ –≤—ã–≤–µ–¥–µ—Ç accuracy –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

### 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è LLM

1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
     ```
     python generate_llm_finetune_dataset.py
     ```
   - –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –≤ –ø–∞–ø–∫—É `dataset/`

### 5. –û–±—É—á–µ–Ω–∏–µ LLM

1. –û–±—É—á–∏—Ç–µ LLM:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
     ```
     python train_llm.py
     ```
   - –°–∫—Ä–∏–ø—Ç –≤—ã–≥—Ä—É–∑–∏—Ç —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–∏ –≤ –ø–∞–ø–∫—É `finetuned_model/`

### 6. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–∏–ø–ª–µ—Ç–æ–≤ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é LLM:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
     ```
     python main.py
     ```
   - –°–∫—Ä–∏–ø—Ç:
     - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
     - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è tail –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
     - –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM.
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ LLM (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–¥—Ä–µ—Å API –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `rerank_with_llm`).
     - –ü–∞—Ä—Å–∏—Ç –æ—Ç–≤–µ—Ç LLM –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏.

---

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:  
  - torch  
  - numpy  
  - requests  
  - scikit-learn
